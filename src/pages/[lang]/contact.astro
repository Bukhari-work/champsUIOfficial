---
// =================================================================================
// 1. IMPORTS
// =================================================================================

// 1a. Layout & Components
import Base from "@/layouts/Base.astro";
import PageHeader from "@/components/PageHeader.astro";
import DynamicIcon from "@/components/blocks/DynamicIcon.tsx";
import ContactForm from "@/layouts/ContactForm.astro";

// 1b. Config & i18n
import { SETTINGS } from "@/config.ts"; // Assuming you still need this for contact_form_url
import { getLangFromUrl, useTranslations } from "@/i18n/utils.ts";
import type { BaseLayoutProps } from "@/types.ts";

// 1c. Static Path Generation
import { ui } from "@/i18n/ui.ts";

// =================================================================================
// 2.  STATIC PATHS
// =================================================================================

export function getStaticPaths() {
  return Object.keys(ui).map((lang) => {
    return {
      params: { lang: lang },
    };
  });
}
// =================================================================================
// 3. LAYOUT LOGIC & DATA PREPARATION
// =================================================================================

// 3a. Get language and translation function
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// 3b. Define SEO content for Base.astro
const content: BaseLayoutProps["content"] = {
  title: t("contact.seo.title"),
  description: t("contact.seo.description"),
  // canonical: "https://www.champs-ui.org/contact" // Optional: uncomment if needed
};

// 3c. Define data for contact details
const contactDetails = {
  title: t("contact.details.title"), // "Email and Website"
  items: [
    {
      icon: "LuMail",
      text: "champs@ui.ac.id",
      href: "mailto:champs@ui.ac.id",
    },
    {
      icon: "LuMail",
      text: "champsui09@gmail.com",
      href: "mailto:champsui09@gmail.com",
    },
    {
      icon: "LuGlobe",
      text: "www.champs-ui.org",
      href: "/", // Assumes root link
    },
  ],
};

// 3d. Define data for social media
const socials = {
  title: t("contact.socials.title"), // "Social Media"
  items: [
    {
      icon: "FaWhatsapp",
      text: "+62 813 2409 6624",
      href: "https://wa.me/+6281324096624",
    },
    {
      icon: "LuFacebook",
      text: "Champs FKM UI",
      href: "https://www.facebook.com/champs.fkmui",
    },
    {
      icon: "LuLinkedin",
      text: "Champs FKM UI",
      href: "https://www.linkedin.com/company/champsui",
    },
    {
      icon: "LuInstagram",
      text: "@champs_UI",
      href: "https://www.instagram.com/champs_ui",
    },
    {
      icon: "LuYoutube",
      text: t("contact.socials.youtube"), // "Pusat Kajian AKK FKM UI"
      href: "https://youtube.com/@champsfphui?si=uADFIoR8DUT7m-RV",
    },
  ],
};

// 3e. Define data for address
const address = {
  title: t("contact.address.title"), // "Address"
  line1: t("contact.address.line1"), // "Room 312, Building G, 3rd Floor of"
  location: t("contact.address.location"), // "Faculty of Public Health Universitas Indonesia"
  locationHref: "https://maps.app.goo.gl/example123", // Your map link
  line2: t("contact.address.line2"), // "Depok, West Java Indonesia"
  gmapEmbedSrc:
    "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3965.241610479638!2d106.8327170153434!3d-6.362768564036663!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e69ec18a7c646b7%3A0x219d443918032748!2sFakultas%20Kesehatan%20Masyarakat%20Universitas%20Indonesia!5e0!3m2!1sen!2sid!4v1678888888888!5m2!1sen!2sid", // Your embed link
};
---

<Base {content} makara>
  <PageHeader title={t("contact.pageHeader")} />

  <section
    class="prose dark:prose-invert relative mx-auto grid max-w-6xl grid-cols-6 gap-6 p-2 pb-24 xl:gap-16"
  >
    <div class="relative col-span-6 min-w-full px-10 font-light lg:col-span-3">
      <h1 class="text-primary mt-8 mb-4 scroll-mt-24">
        {t("contact.intro.title")}
      </h1>
      <article
        id="contactDescription"
        class="mt-4 translate-y-0 space-y-4 opacity-100 transition-all duration-300 ease-in-out"
      >
        <p>
          {t("contact.intro.paragraph")}
        </p>
      </article>

      <ContactForm
        title={t("contact.form.title")}
        url={SETTINGS.contact_form_url}
      />
    </div>

    <article
      class="bg-background dark:shadow-primary/20 right-0 col-span-6 mx-auto mt-6 max-w-xl rounded-xl border p-2.5 px-10 pb-10 font-light shadow-xl lg:col-span-3"
    >
      <div>
        <h3>{contactDetails.title}</h3>
        <ul>
          {
            contactDetails.items.map((item) => (
              <li class="flex flex-row items-center gap-2">
                <DynamicIcon icon={item.icon} />
                <a
                  href={item.href}
                  class="font-light underline decoration-black/20 underline-offset-4 hover:decoration-black dark:decoration-white/50 dark:hover:decoration-white"
                  target={item.href.startsWith("http") ? "_blank" : "_self"}
                  rel="noopener noreferrer"
                >
                  {item.text}
                </a>
              </li>
            ))
          }
        </ul>
      </div>

      <div>
        <h3>{socials.title}</h3>
        <ul>
          {
            socials.items.map((item) => (
              <li class="flex flex-row items-center gap-2">
                <DynamicIcon icon={item.icon} />
                <a
                  href={item.href}
                  class="font-light underline decoration-black/20 underline-offset-4 hover:decoration-black dark:decoration-white/50 dark:hover:decoration-white"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  {item.text}
                </a>
              </li>
            ))
          }
        </ul>
      </div>

      <div>
        <h3>{address.title}</h3>
        <span class="block">
          {address.line1}
          <a
            href={address.locationHref}
            class="font-light underline decoration-black/20 underline-offset-4 hover:decoration-black dark:decoration-white/50 dark:hover:decoration-white"
            target="_blank"
            rel="noopener noreferrer"
          >
            {address.location}
          </a>
          <br />
          {address.line2}
        </span>
        <iframe
          src={address.gmapEmbedSrc}
          allowfullscreen=""
          class="mt-5 h-[300px] w-full rounded-2xl"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
        >
        </iframe>
      </div>
    </article>
  </section>
</Base>
